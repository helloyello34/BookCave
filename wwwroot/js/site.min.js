// Write your JavaScript code.
console.log("JavaScript loaded. site.min.js used")

$(".dropdown-toggle").on('click', function() {
    console.log("dropdown clicked");
    $(this).parent().toggleClass('open');
    var genreVal = $("ul.genre-menu > li > a.btn.btn-success").text();
    genreVal = genreVal.substring(2, genreVal.end);
    $("#selected-genre-view").text("Genre Selected: " + genreVal);
    $("#genre-list").val(genreVal);
    // $("#genre-list").val($("ul.genre-menu > li > a.btn.btn-success").text());
});


$("ul.genre-menu > li > a").on('click', function() {
    $(this).toggleClass("btn-success btn-default");
});



$(".cartbutton").on("click", function(){
    $.post("Cart/AddBook?id=" + $(this).prev().text(), function(data, status) {
        console.log("Success");
    }).fail(function(err) {
        console.log("Unorthorized bitcheees");  
    });
    $(".alert").show;
});

$(".dropbtn").hover(function(){
    $("#dropbtn-span").toggleClass("glyphicon-menu-down");
    $("#dropbtn-span").toggleClass("glyphicon-menu-up");
  });

if($(".sum").length)
{
    calcSum();
}

function calcSum (){
    var sumOfAll = 0;
    $(".sum").each(function() {
        var spans = $(this).parent().prev();
        var price = spans.children(".price").text();
        var quantity = spans.children(".quantity").text();
        var sum = parseFloat(quantity) * parseFloat(price);
        $(this).text(sum);
        sumOfAll += parseFloat(sum);
    });
    console.log(sumOfAll);
    $("p#sum-of-all").text(sumOfAll + "$");

}

$("button.addition").on('click', function() {
    var id = $(this).parent().children(".id").text();
    $.post("Cart/AddBook?id=" + id, function(data, status){
    }); 
    $(this).next().text(parseInt($(this).next().text()) + 1);
    calcSum();
});

$("button.subtract").on('click', function() {
    var id = $(this).parent().children(".id").text();
    $.post("Cart/RemoveBook?id=" + id, function(data, status){
    }); 
    $(this).next().next().text($(this).next().next().text()-1);
    calcSum();
});

$(document).ready(function(){
    $('[data-toggle="popover"]').popover(); 
});

window.setTimeout(function() {
    $(".alert").fadeTo(500, 0).slideUp(500, function(){
        $(this).remove(); 
    });
}, 4000);
